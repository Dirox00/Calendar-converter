Improve functioning with recurrence on event instead of for loops.